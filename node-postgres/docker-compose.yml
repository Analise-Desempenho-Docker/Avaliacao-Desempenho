services:
    backend:
        image: node
        mem_limit: 500m
        cpus: 0.3
        volumes:
            - ./backend:/backend
        ports:
            - 3000:3000
        depends_on:
            - postgres-db
        command: bash -c "cd /backend && npm i && node app"
    postgres-db:
        image: postgres
        mem_limit: 500m
        cpus: 0.3
        environment:
            POSTGRES_DB: ${POSTGRES_DB}
            POSTGRES_USER: ${POSTGRES_USER}
            POSTGRES_PASSWORD: ${POSTGRES_PASSWORD} 
            PGDATA: ${POSTGRES_DATA} 
        volumes: 
            - ./database:/docker-entrypoint-initdb.d/
            - db:${POSTGRES_DATA}        
        ports:
            - "5434:5432"
volumes:
    db:
